# ==================================================
# 1. ICMP Ping Sweep
# ==================================================
alert icmp any any -> $HOME_NET any (msg:"ICMP Ping Sweep Detected"; itype:8; threshold: type both, track by_src, count 5, seconds 10; sid:1000024; rev:2;)

# ==================================================
# 2. Nmap SYN Scan (only on common ports, avoids false positives from single connections)
# ==================================================
alert tcp any any -> $HOME_NET [22,80,443,3306] (msg:"NMAP SYN Scan Detected"; flags:S; threshold: type both, track by_src, count 5, seconds 10; sid:1000001; rev:3;)

# ==================================================
# 3. SSH Brute Force Simulation (detect rapid connection attempts to port 22)
#    Note: This detects connection floods, not auth failures (which Snort can't see)
# ==================================================
alert tcp any any -> $HOME_NET 22 (msg:"SSH Brute Force Attempt Detected"; flags:S; threshold: type both, track by_src, count 5, seconds 10; sid:1000006; rev:2;)

# ==================================================
# 4. SQL Injection (covers your payloads in URI)
# ==================================================
alert tcp any any -> $HOME_NET $HTTP_PORTS (msg:"SQL Injection Detected: OR 1=1"; content:"OR"; nocase; http_uri; content:"1=1"; nocase; http_uri; sid:1000011; rev:2;)
alert tcp any any -> $HOME_NET $HTTP_PORTS (msg:"SQL Injection Detected: UNION SELECT"; content:"UNION"; nocase; http_uri; content:"SELECT"; nocase; http_uri; sid:1000010; rev:2;)
alert tcp any any -> $HOME_NET $HTTP_PORTS (msg:"SQL Injection Detected: Admin Comment"; content:"admin'--"; nocase; http_uri; sid:1000012; rev:2;)

# ==================================================
# 5. XSS Attack (covers your payloads)
# ==================================================
alert tcp any any -> $HOME_NET $HTTP_PORTS (msg:"XSS Detected: <script> tag"; content:"<script"; nocase; http_uri; sid:1000014; rev:2;)
alert tcp any any -> $HOME_NET $HTTP_PORTS (msg:"XSS Detected: onerror event"; content:"onerror"; nocase; http_uri; sid:1000016; rev:2;)
alert tcp any any -> $HOME_NET $HTTP_PORTS (msg:"XSS Detected: javascript:alert"; content:"javascript:alert"; nocase; http_uri; sid:1000015; rev:2;)